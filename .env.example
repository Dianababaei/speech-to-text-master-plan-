# Application Configuration
# This file contains example environment variables for the Speech-to-Text service.
# Copy this file to .env and update the values for your environment.

# ============================================================================
# Database Configuration
# ============================================================================
DATABASE_URL=sqlite:///./transcription.db
# For PostgreSQL: postgresql://user:password@localhost:5432/dbname

# ============================================================================
# Redis Configuration
# ============================================================================
REDIS_URL=redis://localhost:6379/0
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0

# ============================================================================
# Queue Configuration
# ============================================================================
QUEUE_NAME=transcription

# ============================================================================
# File Storage
# ============================================================================
TEMP_AUDIO_DIR=./temp_audio
AUDIO_STORAGE_PATH=/data/audio_storage
AUDIO_RETENTION_HOURS=24
CLEANUP_INTERVAL_MINUTES=60

# ============================================================================
# OpenAI Configuration
# ============================================================================
OPENAI_API_KEY=sk-your-api-key-here
OPENAI_MODEL=whisper-1

# ============================================================================
# Logging Configuration
# ============================================================================
LOG_LEVEL=INFO
LOG_FORMAT=json

# ============================================================================
# Lexicon Configuration
# ============================================================================
DEFAULT_LEXICON=general
LEXICON_CACHE_TTL=3600

# ============================================================================
# Post-Processing Pipeline Configuration
# Each step can be individually enabled/disabled.
# The pipeline processes text in this order:
#   1. Lexicon replacement (domain-specific term fixes)
#   2. Text cleanup (whitespace and punctuation normalization)
#   3. Numeral handling (Persian to English numeral conversion)
#   4. GPT-4o-mini cleanup (advanced formatting and correction via GPT-4o-mini)
# ============================================================================

# Enable lexicon-based term replacement (domain-specific corrections)
# Default: true | Type: boolean
# When enabled, replaces domain-specific terms using configured lexicon
ENABLE_LEXICON_REPLACEMENT=true

# Enable text cleanup and normalization (whitespace, punctuation)
# Default: true | Type: boolean
# When enabled, normalizes whitespace and removes extra punctuation
ENABLE_TEXT_CLEANUP=true

# Enable numeral handling (Persian numerals to English conversion)
# Default: true | Type: boolean
# When enabled, converts Persian numerals (۰-۹) to English (0-9)
ENABLE_NUMERAL_HANDLING=true

# Enable GPT-4o-mini post-processing for advanced transcription cleanup
# Default: true | Type: boolean
#
# When enabled, uses GPT-4o-mini to transform raw medical dictation into
# professional medical reports. Provides approximately 25-35% quality improvement.
#
# Transformations performed:
#   - Fix Persian grammar and spelling errors
#   - Correct medical terminology transcription errors
#   - Remove dictation artifacts and conversational phrases
#   - Apply formal medical report language
#   - Apply proper formatting (ZWNJ, punctuation, parentheses for IDs)
#   - Preserve all medical information without inference or additions
#
# Resilience:
#   - Gracefully falls back to original text on API failure
#   - Never breaks the pipeline or transcription job
#   - Comprehensive error logging for troubleshooting
#
# Cost Considerations:
#   - Adds OpenAI API calls for each transcription (GPT-4o-mini)
#   - Typical cost ~$0.01-0.05 per transcription depending on length
#   - Consider disabling if API quota or budget is a concern
#
# Availability Considerations:
#   - Requires active OpenAI API connection
#   - If API is unavailable, feature gracefully disables
#   - Disable if you want guaranteed fast processing without external API calls
#
ENABLE_GPT_CLEANUP=true

# ============================================================================
# Fuzzy Matching Configuration
# ============================================================================

# Enable fuzzy matching for lexicon term approximation
ENABLE_FUZZY_MATCHING=true

# Minimum similarity threshold for fuzzy matching (0-100, default 85)
FUZZY_MATCH_THRESHOLD=85

# ============================================================================
# Application Settings
# ============================================================================
APP_NAME=Speech-to-Text Service
DEBUG=false

# ============================================================================
# Health Check Configuration
# ============================================================================
HEALTH_CHECK_TIMEOUT=5

# ============================================================================
# API Configuration
# ============================================================================
API_TITLE=Speech-to-Text API
API_VERSION=1.0.0
API_DESCRIPTION=Speech-to-Text transcription service with post-processing
